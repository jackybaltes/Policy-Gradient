<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>Policy Gradient</title>

        <link rel="stylesheet" href="css/reveal.css">
        <link rel="stylesheet" href="css/theme/ntnuerc.css">

        <!-- Theme used for syntax highlighting of code -->
        <link rel="stylesheet" href="lib/css/zenburn.css">
        <script src="https://daybrush.com/scenejs/release/latest/dist/scene.min.js"></script>
		
        <!-- Printing and PDF exports -->
        <script>
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>
        <script src="js/ntnu.js"></script>
    </head>
    <body>
        <div class="reveal">
        <div class="slides">
            
<section id="start" data-state="start">


<!-- Header -->
  

<!-- Background -->


<!-- Slide -->
<div class="jb-slide">

<div class="jb-output-code jb-render">

<!-- start embedded style -->

<!-- end embedded style -->
<div class="jb-output jb-render">

<h1>Policy Gradient</h1>

<p>
      Jacky Baltes<br>
      National Taiwan Normal University<br>
      Taipei, Taiwan<br>
      <a href="mailto:jacky.baltes@ntnu.edu.tw">jacky.baltes@ntnu.edu.tw</a><br>
</p>

30 November 2020
</div><!-- end of jb-output jb-render -->
</div><!-- end of jb-output-code jb-render -->


</div>
<!-- Footer -->

<div class="jb-footer-left plain">
    <span id="id-294fb51d-cc53-438f-a913-e755a9b7b4df" ><span id="id-294fb51d-cc53-438f-a913-e755a9b7b4df"><img id="img-id-294fb51d-cc53-438f-a913-e755a9b7b4df"     src="assets/images/logo.png"/></span>
</span>

</div>
<div class="jb-footer-right plain">
    <span id="id-4ee483ae-1fd3-4a8a-a45d-031a3b080772" ><span id="id-4ee483ae-1fd3-4a8a-a45d-031a3b080772"><img id="img-id-4ee483ae-1fd3-4a8a-a45d-031a3b080772" width="162" height="138"   src="assets/images/robbi.png"/></span>
</span>

</div>

<aside class="notes">

</aside>



</section>
<section id="slide_00003_frag_00001" data-state="slide_00003_frag_00001">


<!-- Header -->
  

<!-- Background -->


<!-- Slide -->
<div class="jb-slide">

<div class="jb-output-code jb-render">

<!-- start embedded style -->

<!-- end embedded style -->
<div class="jb-output jb-render">
<div class="document">
<div class="jb-text docutils container">
<p>So far, we used either a value function <em>V(s)</em> or an action-value function <em>Q(s,a)</em> to
learn knowledge about the domain</p>
<p>A policy is then derived from the value function or action-value function</p>
<p>An example is the <em>Ɛ</em>-Greedy policy</p>
</div>
</div>

</div><!-- end of jb-output jb-render -->
</div><!-- end of jb-output-code jb-render -->


</div>
<!-- Footer -->

<div class="jb-footer-left plain">
    <span id="id-6f536a62-a41b-44fd-a7f8-621c0b244f71" ><span id="id-6f536a62-a41b-44fd-a7f8-621c0b244f71"><img id="img-id-6f536a62-a41b-44fd-a7f8-621c0b244f71"     src="assets/images/logo.png"/></span>
</span>

</div>
<div class="jb-footer-right plain">
    <span id="id-a461bd92-27cf-450d-9d12-209e8538c1ee" ><span id="id-a461bd92-27cf-450d-9d12-209e8538c1ee"><img id="img-id-a461bd92-27cf-450d-9d12-209e8538c1ee" width="162" height="138"   src="assets/images/robbi.png"/></span>
</span>

</div>

<aside class="notes">

</aside>



</section>
<section id="slide_00004_frag_00001" data-state="slide_00004_frag_00001">


<!-- Header -->
  

<!-- Background -->


<!-- Slide -->
<div class="jb-slide">

<div class="jb-output-code jb-render">

<!-- start embedded style -->

<!-- end embedded style -->
<div class="jb-output jb-render">

<div class="jb-text">
<p>Not clear if value or action-value representation is the best representation of learned knowledge</p>

<p>Policy for a Markov reward process (MRP)</p>

<p>In policy gradient, we parameterize the policy <emph>π</emph> directly</p>
    <div class="jb-math" style="background:white;text-align:center">
    <span id="id-e7dce063-9def-4661-886c-dfb4797aa096" ><span id="id-e7dce063-9def-4661-886c-dfb4797aa096"><img id="img-id-e7dce063-9def-4661-886c-dfb4797aa096"     src="assets/images/eq1.svg"/></span>
</span>

    </div>
    where <emph>θ</emph> is a parameterization of the policy
</div>
</div><!-- end of jb-output jb-render -->
</div><!-- end of jb-output-code jb-render -->


</div>
<!-- Footer -->

<div class="jb-footer-left plain">
    <span id="id-179447c2-3031-4374-b4ec-ae9878f45d1c" ><span id="id-179447c2-3031-4374-b4ec-ae9878f45d1c"><img id="img-id-179447c2-3031-4374-b4ec-ae9878f45d1c"     src="assets/images/logo.png"/></span>
</span>

</div>
<div class="jb-footer-right plain">
    <span id="id-5f26d214-b33c-4469-9aca-0e53e4b13c4f" ><span id="id-5f26d214-b33c-4469-9aca-0e53e4b13c4f"><img id="img-id-5f26d214-b33c-4469-9aca-0e53e4b13c4f" width="162" height="138"   src="assets/images/robbi.png"/></span>
</span>

</div>

<aside class="notes">

</aside>



</section>
<section id="slide_00005_frag_00001" data-state="slide_00005_frag_00001">


<!-- Header -->
  

<!-- Background -->


<!-- Slide -->
<div class="jb-slide">

<div class="jb-output-code jb-render">

<!-- start embedded style -->

<!-- end embedded style -->
<div class="jb-output jb-render">

<h1>Value-based vs. Policy-based Reinforcement Learning</h1>

<table>
<tr>
<td style="width:70%; font-size:0.5em">
<ul>
<li>Value-based
<ul>
<li>Learnt Value function</li>
<li>Implicit policy</li>
</ul>
</li>
<li>Policy-based
<ul>
<li>No Value function</li>
<li>Learnt policy</li>
</ul>
</li>
<li>Actor-Critic
<ul>
<li>Learnt Value function</li>
<li>Learnt policy</li>
</ul>
</li>
</ul>
</td>
<td>
<span id="id-001bc9d6-df07-4cc9-9ecd-ac500c895f16" ><span id="id-001bc9d6-df07-4cc9-9ecd-ac500c895f16"><img id="img-id-001bc9d6-df07-4cc9-9ecd-ac500c895f16"     src="assets/images/v1.svg"/></span>
</span>

</td>
</tr>
</table>
</div><!-- end of jb-output jb-render -->
</div><!-- end of jb-output-code jb-render -->


</div>
<!-- Footer -->

<div class="jb-footer-left plain">
    <span id="id-a9617a20-d7a7-4153-b487-6451e6a1d4dd" ><span id="id-a9617a20-d7a7-4153-b487-6451e6a1d4dd"><img id="img-id-a9617a20-d7a7-4153-b487-6451e6a1d4dd"     src="assets/images/logo.png"/></span>
</span>

</div>
<div class="jb-footer-right plain">
    <span id="id-0beca914-ec37-4d57-9aaa-a25e455fe44d" ><span id="id-0beca914-ec37-4d57-9aaa-a25e455fe44d"><img id="img-id-0beca914-ec37-4d57-9aaa-a25e455fe44d" width="162" height="138"   src="assets/images/robbi.png"/></span>
</span>

</div>

<aside class="notes">

</aside>



</section>
<section id="slide_00006_frag_00001" data-state="slide_00006_frag_00001">


<!-- Header -->
  

<!-- Background -->


<!-- Slide -->
<div class="jb-slide">

<div class="jb-output-code jb-render">

<!-- start embedded style -->

<!-- end embedded style -->
<div class="jb-output jb-render">
<div class="document" id="policy-based-approach">
<h1 class="title">Policy-based Approach</h1>
<div class="jb-text docutils container">
<p>Advantages</p>
<ul class="simple">
<li>Better convergence properties</li>
<li>High-dimensional or continuous action spaces</li>
<li>Policy may be probabilistic</li>
</ul>
<p>Disadvantages</p>
<ul class="simple">
<li>Find local maximum, not global maximum.
Apply random restart to try and improve current local maximum</li>
<li>Evaluating policy is inefficient</li>
<li>Problematic if variance of the policy is high</li>
</ul>
</div>
</div>

</div><!-- end of jb-output jb-render -->
</div><!-- end of jb-output-code jb-render -->


</div>
<!-- Footer -->

<div class="jb-footer-left plain">
    <span id="id-cd9a720d-db2b-4cd5-b605-ec8ae42cb45e" ><span id="id-cd9a720d-db2b-4cd5-b605-ec8ae42cb45e"><img id="img-id-cd9a720d-db2b-4cd5-b605-ec8ae42cb45e"     src="assets/images/logo.png"/></span>
</span>

</div>
<div class="jb-footer-right plain">
    <span id="id-21a308a5-c308-4552-be3a-860485a6d57c" ><span id="id-21a308a5-c308-4552-be3a-860485a6d57c"><img id="img-id-21a308a5-c308-4552-be3a-860485a6d57c" width="162" height="138"   src="assets/images/robbi.png"/></span>
</span>

</div>

<aside class="notes">

</aside>



</section>
<section id="slide_00007_frag_00001" data-state="slide_00007_frag_00001">


<!-- Header -->
  

<!-- Background -->


<!-- Slide -->
<div class="jb-slide">
<div class="jb-input jb-render jb-code" style="text-align:center">

<!-- start embedded style -->

<!-- end embedded style -->
<div class="jb-input-code jb-render">
<div class="highlight" style="background: #f8f8f8; color:#101010;display=inline-block;"><pre style="line-height: 125%"><span></span>transitions <span style="color: #666666">=</span> np<span style="color: #666666">.</span>array( [ [ <span style="color: #666666">1</span>, <span style="color: #666666">0</span>, <span style="color: #666666">2</span> ],
                          [ <span style="color: #666666">3</span>, <span style="color: #666666">3</span>, <span style="color: #666666">0</span> ],
                          [ <span style="color: #666666">1</span>, <span style="color: #666666">3</span>, <span style="color: #666666">0</span>, ] ] )

rewards <span style="color: #666666">=</span> np<span style="color: #666666">.</span>array( [ [ <span style="color: #666666">0</span>, <span style="color: #666666">-5</span>, <span style="color: #666666">0</span> ],
                      [ <span style="color: #666666">-50</span>, <span style="color: #666666">100</span>, <span style="color: #666666">-1</span> ],
                      [ <span style="color: #666666">-10</span>, <span style="color: #666666">10</span>, <span style="color: #666666">-1</span> ] ] )

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">successor</span>( s, a, transitions, rewards ):
  ns <span style="color: #666666">=</span> transitions[s,a]
  r <span style="color: #666666">=</span> rewards[s,a]
  <span style="color: #008000; font-weight: bold">return</span> ns, r

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">applyPolicy</span>( pol, s ):
  val <span style="color: #666666">=</span> [ p <span style="color: #008000; font-weight: bold">for</span> p <span style="color: #AA22FF; font-weight: bold">in</span> pol[s] ]
  <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(val)):
    v <span style="color: #666666">=</span> val[i]
    <span style="color: #008000; font-weight: bold">if</span> (v <span style="color: #666666">&lt;</span> <span style="color: #666666">0.0</span> ):
      v <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>
    <span style="color: #008000; font-weight: bold">elif</span> ( v <span style="color: #666666">&gt;</span> <span style="color: #666666">1.0</span>):
      v <span style="color: #666666">=</span> <span style="color: #666666">1.0</span>
    val[i] <span style="color: #666666">=</span> v
  
  vSum <span style="color: #666666">=</span> <span style="color: #008000">sum</span>(val)
  <span style="color: #008000; font-weight: bold">if</span> (vSum <span style="color: #666666">&gt;</span> <span style="color: #666666">1</span>):
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(val)):
      v <span style="color: #666666">=</span> val[i]<span style="color: #666666">/</span>(<span style="color: #666666">1.00*</span>vSum)

  val<span style="color: #666666">.</span>append(<span style="color: #666666">1-</span><span style="color: #008000">sum</span>(val))

  cpol <span style="color: #666666">=</span> np<span style="color: #666666">.</span>cumsum( val )
  r <span style="color: #666666">=</span> random<span style="color: #666666">.</span>random()
  a <span style="color: #666666">=</span> <span style="color: #666666">0</span>
  <span style="color: #008000; font-weight: bold">while</span>( a <span style="color: #666666">&lt;</span> <span style="color: #008000">len</span>(pol) <span style="color: #AA22FF; font-weight: bold">and</span> ( cpol[a] <span style="color: #666666">&lt;</span> r ) ):
    a <span style="color: #666666">=</span> a <span style="color: #666666">+</span> <span style="color: #666666">1</span>
  <span style="color: #008000; font-weight: bold">return</span> a
</pre></div>

</div><!-- end of jb-input-code jb-render -->

</div>

</div>
<!-- Footer -->

<div class="jb-footer-left plain">
    <span id="id-f13ba4ba-8965-4f32-91a9-b0be559234a6" ><span id="id-f13ba4ba-8965-4f32-91a9-b0be559234a6"><img id="img-id-f13ba4ba-8965-4f32-91a9-b0be559234a6"     src="assets/images/logo.png"/></span>
</span>

</div>
<div class="jb-footer-right plain">
    <span id="id-10401659-bc01-4eb9-881a-60b9542aad13" ><span id="id-10401659-bc01-4eb9-881a-60b9542aad13"><img id="img-id-10401659-bc01-4eb9-881a-60b9542aad13" width="162" height="138"   src="assets/images/robbi.png"/></span>
</span>

</div>

<aside class="notes">

</aside>



</section>
<section id="slide_00008_frag_00001" data-state="slide_00008_frag_00001">


<!-- Header -->
  

<!-- Background -->


<!-- Slide -->
<div class="jb-slide">

<div class="jb-output-code jb-render">

<!-- start embedded style -->

<!-- end embedded style -->
<div class="jb-output jb-render">

<h1>Policy Objective Function</h1>

<div class="jb-text">
<p>Given policy \(\pi_\theta(s,a)\) with parameters \(\theta\), find best \(\theta\)</p>

<p>Evaluate policy \(\pi_{\theta}\)</p>

<ul>
<li>Given an entire episode: $$J_{1}(\theta) = V^{\pi_{\theta}}(s_1) = \mathbb{E}_{\pi_\theta}[v_1]$$</li>

<li>Given a contiuous environment: use average value: $$J_{avV}(\theta) = \sum_{s} d^{\pi\theta}(s)V^{\pi_\theta}(s)$$</li>

<li>Or average reward per time step: $$J_{avR}(\theta) = \sum_{s} d^{\pi\theta}(s)R^{a}_{s}$$</li>

</ul>

<p>where \(d^{\pi_\theta}(s)\) is the stationary distribution of the Markov chain for \(\pi_\theta\).</p>

</div>
</div><!-- end of jb-output jb-render -->
</div><!-- end of jb-output-code jb-render -->


</div>
<!-- Footer -->

<div class="jb-footer-left plain">
    <span id="id-a76ea9ce-422c-4e7e-87b2-c97171b1a14d" ><span id="id-a76ea9ce-422c-4e7e-87b2-c97171b1a14d"><img id="img-id-a76ea9ce-422c-4e7e-87b2-c97171b1a14d"     src="assets/images/logo.png"/></span>
</span>

</div>
<div class="jb-footer-right plain">
    <span id="id-137b0121-c1e1-4383-8336-4597c00977ad" ><span id="id-137b0121-c1e1-4383-8336-4597c00977ad"><img id="img-id-137b0121-c1e1-4383-8336-4597c00977ad" width="162" height="138"   src="assets/images/robbi.png"/></span>
</span>

</div>

<aside class="notes">

</aside>



</section>
<section id="slide_00009_frag_00001" data-state="slide_00009_frag_00001">


<!-- Header -->
  

<!-- Background -->


<!-- Slide -->
<div class="jb-slide">

<div class="jb-output-code jb-render">

<!-- start embedded style -->

<!-- end embedded style -->
<div class="jb-output jb-render">

<h1>Evaluation of Policy</h1>

<div class="jb-text">
<p>The policy evaluation may be noisy as in this example</p>

<p>The blue line is the reward for each episode, the red line is the average reward per episode</p>

<div class="jb-img" style="text-align:center;">
    <span id="id-c7e38cce-8af1-4056-8062-55b3cd0cdc8e" ><span id="id-c7e38cce-8af1-4056-8062-55b3cd0cdc8e"><img id="img-id-c7e38cce-8af1-4056-8062-55b3cd0cdc8e"     src="assets/images/figvar.svg"/></span>
</span>

</div>

<p>You can see the large swings in the blue line, which makes learning difficult.</p>

<p>However, in this case, the red line converges quickly</p>
</div>
</div><!-- end of jb-output jb-render -->
</div><!-- end of jb-output-code jb-render -->


</div>
<!-- Footer -->

<div class="jb-footer-left plain">
    <span id="id-eaea3032-59fb-4e75-b273-ab0d264a3a46" ><span id="id-eaea3032-59fb-4e75-b273-ab0d264a3a46"><img id="img-id-eaea3032-59fb-4e75-b273-ab0d264a3a46"     src="assets/images/logo.png"/></span>
</span>

</div>
<div class="jb-footer-right plain">
    <span id="id-8b5782f6-f7c4-4400-afb8-a24bab6ef7e3" ><span id="id-8b5782f6-f7c4-4400-afb8-a24bab6ef7e3"><img id="img-id-8b5782f6-f7c4-4400-afb8-a24bab6ef7e3" width="162" height="138"   src="assets/images/robbi.png"/></span>
</span>

</div>

<aside class="notes">

</aside>



</section>
<section id="slide_00010_frag_00001" data-state="slide_00010_frag_00001">


<!-- Header -->
  

<!-- Background -->


<!-- Slide -->
<div class="jb-slide">

<div class="jb-output-code jb-render">

<!-- start embedded style -->

<!-- end embedded style -->
<div class="jb-output jb-render">
<div class="document">
<div class="jb-text docutils container">
<p>Policy-based reinforcement learning is an optimisation problem</p>
<p>Find $\theta$ that maximizes $J(\theta)$</p>
<p>Some approaches do not use gradient</p>
<ul class="simple">
<li>Hill climbing</li>
<li>Simplex/amoeba/Nelder Mead</li>
<li>Genetic algorithms</li>
</ul>
<p>Usually more efficient when using gradient</p>
<ul class="simple">
<li>Gradient descent</li>
<li>Conjugate gradient</li>
<li>Quasi-Newton method</li>
</ul>
<p>Most popular one is gradient descent with extensions for sequential structure of problem</p>
</div>
</div>

</div><!-- end of jb-output jb-render -->
</div><!-- end of jb-output-code jb-render -->


</div>
<!-- Footer -->

<div class="jb-footer-left plain">
    <span id="id-638444d0-1f49-456b-8bda-54bb4e57be9c" ><span id="id-638444d0-1f49-456b-8bda-54bb4e57be9c"><img id="img-id-638444d0-1f49-456b-8bda-54bb4e57be9c"     src="assets/images/logo.png"/></span>
</span>

</div>
<div class="jb-footer-right plain">
    <span id="id-40e6aace-53d4-47ac-b5de-35b46f4b2c99" ><span id="id-40e6aace-53d4-47ac-b5de-35b46f4b2c99"><img id="img-id-40e6aace-53d4-47ac-b5de-35b46f4b2c99" width="162" height="138"   src="assets/images/robbi.png"/></span>
</span>

</div>

<aside class="notes">

</aside>



</section>
<section id="slide_00011_frag_00001" data-state="slide_00011_frag_00001">


<!-- Header -->
  

<!-- Background -->


<!-- Slide -->
<div class="jb-slide">

<div class="jb-output-code jb-render">

<!-- start embedded style -->

<!-- end embedded style -->
<div class="jb-output jb-render">

<h1>Finite Differences Method</h1>

<div class="jb-text">
<ul>
<li>

    Policy gradient \(\nabla_{\theta} \pi_{\theta}(s,a)\) is defined as partial derivative of \(J(\theta)\) for each parameter \(\theta_i\)
</li>
<li>
    By changing each \(\theta_i\) a little bit, we can estimate the gradient. 
    \[\frac{J(\delta \theta)}{\delta \theta_k} \approx \frac{J(\theta + \epsilon u_k) - J(\theta)}{\epsilon}\]
    where \(u_k\) is a unit vector with 1 in \(k\)-th component and 0 elsewhere
</li>
<li>
    Requires \(n\) evaluations for a policy \(\pi_\theta\) with \(n\) parameters \(\theta_0, \theta_1, ... \theta_n\)
</li>
<li>    
    Simple, inefficient, and susceptible to noise
</li>
<li>
    Works for any policy, even if the policy is not differentiable
</li>
</div>
</div><!-- end of jb-output jb-render -->
</div><!-- end of jb-output-code jb-render -->


</div>
<!-- Footer -->

<div class="jb-footer-left plain">
    <span id="id-da4249ff-831d-4a9b-b86d-29a41adf8de7" ><span id="id-da4249ff-831d-4a9b-b86d-29a41adf8de7"><img id="img-id-da4249ff-831d-4a9b-b86d-29a41adf8de7"     src="assets/images/logo.png"/></span>
</span>

</div>
<div class="jb-footer-right plain">
    <span id="id-1739371a-811e-4473-94e3-1d1bb4809e14" ><span id="id-1739371a-811e-4473-94e3-1d1bb4809e14"><img id="img-id-1739371a-811e-4473-94e3-1d1bb4809e14" width="162" height="138"   src="assets/images/robbi.png"/></span>
</span>

</div>

<aside class="notes">

label slide_00011_frag_00001:


JB: Hello. So how do we calculate the gradient?


C: Hm. Actually - Prof - what is a gradient. Could you remind me?


# Lyrebird
</aside>



</section>
<section id="slide_00012_frag_00001" data-state="slide_00012_frag_00001">


<!-- Header -->
  

<!-- Background -->


<!-- Slide -->
<div class="jb-slide">

<div class="jb-output-code jb-render">

<!-- start embedded style -->

<!-- end embedded style -->
<div class="jb-output jb-render">

<h1>Analytical Solution</h1>

<div class="jb-text">
<ul>
<li>
    Calculate the policy gradient \(\nabla_{\theta} \pi_{\theta}(s,a)\) analytically may lead to better convergence
</li>

<li>
    Likelihood ratios
</li>
<ul>
<li>
    \[
      \begin{equation}
    \nabla_{\theta} \pi_{\theta}(s,a) = \pi_{\theta}(s,a) \frac{\nabla_{\theta} \pi_{\theta}(s,a)}{\pi_{\theta}(s,a)}\\\\
    \ \ \ \ \ \ \ \ = \pi_{\theta}(s,a) \nabla_{\theta} \log \pi_{\theta}(s,a)
    \end{equation}
    \]
</li>
<li>
    Score function
</li>
<ul>
<li>
    \[
    \nabla_{\theta} \log \pi_{\theta}(s,a)
    \]
</li>
</ul>
</ul>
</div>
</div><!-- end of jb-output jb-render -->
</div><!-- end of jb-output-code jb-render -->


</div>
<!-- Footer -->

<div class="jb-footer-left plain">
    <span id="id-a9efeeba-d78c-4fba-98ad-013d502770a6" ><span id="id-a9efeeba-d78c-4fba-98ad-013d502770a6"><img id="img-id-a9efeeba-d78c-4fba-98ad-013d502770a6"     src="assets/images/logo.png"/></span>
</span>

</div>
<div class="jb-footer-right plain">
    <span id="id-3fc49613-99f6-4ec1-abc8-53df897bdf61" ><span id="id-3fc49613-99f6-4ec1-abc8-53df897bdf61"><img id="img-id-3fc49613-99f6-4ec1-abc8-53df897bdf61" width="162" height="138"   src="assets/images/robbi.png"/></span>
</span>

</div>

<aside class="notes">

</aside>



</section>
<section id="slide_00013_frag_00001" data-state="slide_00013_frag_00001">


<!-- Header -->
  

<!-- Background -->


<!-- Slide -->
<div class="jb-slide">

<div class="jb-output-code jb-render">

<!-- start embedded style -->

<!-- end embedded style -->
<div class="jb-output jb-render">
<div class="document" id="monte-carlo-policy-gradient-reinforce">
<h1 class="title">Monte-Carlo Policy Gradient (REINFORCE)</h1>
<div class="jb-text docutils container">
<pre class="code python literal-block">
<span class="keyword">def</span> <span class="name function">REINFORCE</span><span class="punctuation">(</span> <span class="name">alpha</span><span class="punctuation">,</span> <span class="name">traces</span> <span class="punctuation">):</span>
    <span class="name">theta</span> <span class="operator">=</span> <span class="name">np</span><span class="operator">.</span><span class="name">zeros</span><span class="punctuation">((</span><span class="name builtin">len</span><span class="punctuation">(</span><span class="name">model</span><span class="punctuation">)))</span>
    <span class="keyword">for</span> <span class="name">t</span> <span class="operator word">in</span> <span class="name">trace</span><span class="punctuation">:</span>
        <span class="keyword">for</span> <span class="name">step</span> <span class="operator word">in</span> <span class="name">t</span><span class="punctuation">:</span>
            <span class="name">st</span><span class="punctuation">,</span><span class="name">at</span><span class="punctuation">,</span><span class="name">vt</span> <span class="operator">=</span> <span class="name">step</span>
            <span class="name">dtheta</span> <span class="operator">=</span> <span class="name">dtheta</span> <span class="operator">+</span> <span class="name">alpha</span> <span class="operator">*</span> <span class="name">grad</span> <span class="operator">*</span> <span class="name">math</span><span class="operator">.</span><span class="name">log</span><span class="punctuation">(</span> <span class="name">p</span><span class="punctuation">(</span><span class="name">st</span><span class="punctuation">,</span><span class="name">at</span><span class="punctuation">)</span> <span class="punctuation">)</span><span class="operator">*</span> <span class="name">vt</span>
    <span class="name">theta</span> <span class="operator">=</span> <span class="name">theta</span> <span class="operator">+</span> <span class="name">dtheta</span>
    <span class="keyword">return</span> <span class="name">theta</span>
</pre>
</div>
</div>

</div><!-- end of jb-output jb-render -->
</div><!-- end of jb-output-code jb-render -->


</div>
<!-- Footer -->

<div class="jb-footer-left plain">
    <span id="id-3202ecd0-a951-4ef2-9307-d24c92c9972c" ><span id="id-3202ecd0-a951-4ef2-9307-d24c92c9972c"><img id="img-id-3202ecd0-a951-4ef2-9307-d24c92c9972c"     src="assets/images/logo.png"/></span>
</span>

</div>
<div class="jb-footer-right plain">
    <span id="id-aa425a5b-5c94-4cac-9614-b6eb9fc49798" ><span id="id-aa425a5b-5c94-4cac-9614-b6eb9fc49798"><img id="img-id-aa425a5b-5c94-4cac-9614-b6eb9fc49798" width="162" height="138"   src="assets/images/robbi.png"/></span>
</span>

</div>

<aside class="notes">

</aside>



</section>
<section id="slide_00014_frag_00001" data-state="slide_00014_frag_00001">


<!-- Header -->
  

<!-- Background -->


<!-- Slide -->
<div class="jb-slide">

<div class="jb-output-code jb-render">

<!-- start embedded style -->

<!-- end embedded style -->
<div class="jb-output jb-render">

<h1>Actor-Critic Model</h1>
<div class="jb-text">
<ul>
<li>
Critic to estimate Q-values \(Q_W(s,a) \approx Q^{\pi_\theta}(s,a)\)
</li>
<ul>
        <li>Reduce variance during training</li>
</ul>
<li>
    Actor-Critic systems
</li>
<ul>
<li>
        Critic - Updates estimates of Q-values parameters \(w\)
</li>
<li>
        Actor - Updates policy parameters \(\theta\)
</li>
</ul>
<li>
    Follow approximate policy gradient
</li>
<ul>
<li>
        \[
        \nabla J(\theta) \approx \mathbb{E}[\nabla_\theta \log \pi_\theta Q_w(s,a)] \\
        \Delta \theta = \alpha \nabla_\theta \log \pi_\theta Q_w(s,a)
        \]
</li>
</ul>
</ul>
</div>
</div><!-- end of jb-output jb-render -->
</div><!-- end of jb-output-code jb-render -->


</div>
<!-- Footer -->

<div class="jb-footer-left plain">
    <span id="id-9e3ce056-5bde-416b-ac1c-8255028790be" ><span id="id-9e3ce056-5bde-416b-ac1c-8255028790be"><img id="img-id-9e3ce056-5bde-416b-ac1c-8255028790be"     src="assets/images/logo.png"/></span>
</span>

</div>
<div class="jb-footer-right plain">
    <span id="id-b209ebef-8c3e-44c4-96d0-0903c921c1e1" ><span id="id-b209ebef-8c3e-44c4-96d0-0903c921c1e1"><img id="img-id-b209ebef-8c3e-44c4-96d0-0903c921c1e1" width="162" height="138"   src="assets/images/robbi.png"/></span>
</span>

</div>

<aside class="notes">

</aside>



</section>
<section id="slide_00015_frag_00001" data-state="slide_00015_frag_00001">


<!-- Header -->
  

<!-- Background -->


<!-- Slide -->
<div class="jb-slide">

<div class="jb-output-code jb-render">

<!-- start embedded style -->

<!-- end embedded style -->
<div class="jb-output jb-render">

<h1>Critic</h1>
<div class="jb-text">
<ul>
<li>
    Critic evaluates the policy \(\pi_\theta\) with parameter \(\theta\)
</li>
<li>
        Monte-Carlo policy evaluation 
</li>
<li>
        Temporal difference learning
</li>
<li>
        TD(\(\lambda\))
</li>
<li>
        Least-squares policy evaluation
</li>
</ul>
</div>
</div><!-- end of jb-output jb-render -->
</div><!-- end of jb-output-code jb-render -->


</div>
<!-- Footer -->

<div class="jb-footer-left plain">
    <span id="id-90b17192-0487-40b1-9969-585fd65a668d" ><span id="id-90b17192-0487-40b1-9969-585fd65a668d"><img id="img-id-90b17192-0487-40b1-9969-585fd65a668d"     src="assets/images/logo.png"/></span>
</span>

</div>
<div class="jb-footer-right plain">
    <span id="id-9889e277-73e7-4598-a473-490e245ba6ea" ><span id="id-9889e277-73e7-4598-a473-490e245ba6ea"><img id="img-id-9889e277-73e7-4598-a473-490e245ba6ea" width="162" height="138"   src="assets/images/robbi.png"/></span>
</span>

</div>

<aside class="notes">

</aside>



</section>
        </div>
        </div>

        <script src="js/reveal.js"></script>

        <script>
            // More info about config & dependencies:
            // - https://github.com/hakimel/reveal.js#configuration
            // - https://github.com/hakimel/reveal.js#dependencies
            Reveal.initialize({
                math: {
                    mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
                    config: 'TeX-AMS_HTML-full',  // See http://docs.mathjax.org/en/latest/config-files.html
                    // tex2jax: {
                    //     inlineMath: [['$', '$'], ['\(', '\)']],
                    //     displayMath: [['$$', '$$'], ['\[', '\]']],
                    //     processEscapes: true,
                    //     processEnvironments: true,
                    //     skipTags: ['script', 'noscript', 'style', 'textarea', 'code', 'pre'],
                    //     displayAlign: 'center',
                    // }                
                },
                dependencies: [
                    { src: 'plugin/markdown/marked.js' },
                    { src: 'plugin/markdown/markdown.js' },
                    { src: 'plugin/notes/notes.js', async: true },
                    { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'plugin/math/math.js', async: true }
                ]
            });
        </script>

        <script>
            <!-- Assets -->
var assets = {
"robbi" : new JBImage( "robbi", "12677", "162", "138", null, null, "assets/images/robbi", "png" ),
"logo" : new JBImage( "logo", "12033", "0", "0", null, null, "assets/images/logo", "png" ),
"fira-logo-1" : new JBImage( "fira-logo-1", "93836", "0", "0", null, null, "assets/images/FIRA-logo-1", "png" ),
"pairLogo" : new JBImage( "pairLogo", "63051", "0", "0", null, null, "assets/images/pairLogo", "png" ),
"eq1" : new JBImage( "eq1", "9699", "0", "0", null, null, "assets/images/eq1", "svg" ),
"v1" : new JBImage( "v1", "16574", "0", "0", null, null, "assets/images/v1", "svg" ),
"figvar" : new JBImage( "figvar", "18972", "0", "0", null, null, "assets/images/figvar", "svg" ) 
};
var assetInstances = {
    "id-4ee483ae-1fd3-4a8a-a45d-031a3b080772": assets["robbi"],
    "id-a461bd92-27cf-450d-9d12-209e8538c1ee": assets["robbi"],
    "id-5f26d214-b33c-4469-9aca-0e53e4b13c4f": assets["robbi"],
    "id-0beca914-ec37-4d57-9aaa-a25e455fe44d": assets["robbi"],
    "id-21a308a5-c308-4552-be3a-860485a6d57c": assets["robbi"],
    "id-10401659-bc01-4eb9-881a-60b9542aad13": assets["robbi"],
    "id-137b0121-c1e1-4383-8336-4597c00977ad": assets["robbi"],
    "id-8b5782f6-f7c4-4400-afb8-a24bab6ef7e3": assets["robbi"],
    "id-40e6aace-53d4-47ac-b5de-35b46f4b2c99": assets["robbi"],
    "id-1739371a-811e-4473-94e3-1d1bb4809e14": assets["robbi"],
    "id-3fc49613-99f6-4ec1-abc8-53df897bdf61": assets["robbi"],
    "id-aa425a5b-5c94-4cac-9614-b6eb9fc49798": assets["robbi"],
    "id-b209ebef-8c3e-44c4-96d0-0903c921c1e1": assets["robbi"],
    "id-9889e277-73e7-4598-a473-490e245ba6ea": assets["robbi"],
    "id-294fb51d-cc53-438f-a913-e755a9b7b4df": assets["logo"],
    "id-6f536a62-a41b-44fd-a7f8-621c0b244f71": assets["logo"],
    "id-179447c2-3031-4374-b4ec-ae9878f45d1c": assets["logo"],
    "id-a9617a20-d7a7-4153-b487-6451e6a1d4dd": assets["logo"],
    "id-cd9a720d-db2b-4cd5-b605-ec8ae42cb45e": assets["logo"],
    "id-f13ba4ba-8965-4f32-91a9-b0be559234a6": assets["logo"],
    "id-a76ea9ce-422c-4e7e-87b2-c97171b1a14d": assets["logo"],
    "id-eaea3032-59fb-4e75-b273-ab0d264a3a46": assets["logo"],
    "id-638444d0-1f49-456b-8bda-54bb4e57be9c": assets["logo"],
    "id-da4249ff-831d-4a9b-b86d-29a41adf8de7": assets["logo"],
    "id-a9efeeba-d78c-4fba-98ad-013d502770a6": assets["logo"],
    "id-3202ecd0-a951-4ef2-9307-d24c92c9972c": assets["logo"],
    "id-9e3ce056-5bde-416b-ac1c-8255028790be": assets["logo"],
    "id-90b17192-0487-40b1-9969-585fd65a668d": assets["logo"],
    "id-e7dce063-9def-4661-886c-dfb4797aa096": assets["eq1"],
    "id-001bc9d6-df07-4cc9-9ecd-ac500c895f16": assets["v1"],
    "id-c7e38cce-8af1-4056-8062-55b3cd0cdc8e": assets["figvar"]
};
<!-- End of Assets -->

            convertURLs(assetInstances, "smart-path");
        </script>
        <script>
            <!-- Characters -->
var characters =
{};
<!-- End of Characters -->

        </script>
    </body>
</html>